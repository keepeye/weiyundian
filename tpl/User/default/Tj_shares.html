<include file="Public:head"/>  
<script src="__PUBLIC__/highcharts/highcharts.js"></script>
<link rel="stylesheet" type="text/css" href="./tpl/User/default/common/css/cymain.css">
<div class="content">
	
	<div class="tab">
		<ul>
		<li class="tabli" id="tab0"><a href="{pigcms::U('index')}">整体概况</a></li>
		<li class="current tabli" id="tab3"><a href="{pigcms::U('shares')}">转发统计</a></li>
		</ul>
	</div>
	<div class="msgWrap">
		<div id="today_charts">
			
		</div>

		<br/>
		<div id="yestoday_charts">
			
		</div>

		<br/>
		<br/>
		<div id="month_charts">
			
		</div>
	</div>
	<div class="cLine">
		<div class="pageNavigator right">
			<div class="pages">{pigcms:$page}</div>
		</div>
		<div class="clr"></div>
	</div>
</div>
<div class="clr"></div>
<script>
	$(function () {
		$('#today_charts').highcharts({
			credits:{
            	enabled:false
            },
			chart: {
				plotBackgroundColor: null,
				plotBorderWidth: null,
				plotShadow: false
			},
			title: {
				text: '今天被分享次数最多的前十个文档'
			},
			tooltip: {
				pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
			},
			plotOptions: {
				pie: {
					allowPointSelect: true,
					cursor: 'pointer',
					dataLabels: {
						enabled: true,
						color: '#000000',
						connectorColor: '#000000',
						format: '<b>{point.name}</b>: {y}次'
					}
				}
			},
			series: [{
				type: 'pie',
				name: '次数',
				data: [
				<?php foreach($today_list as $k=>$v): ?>
					<?php if($k==0): ?>
					{
	                    name: '<?php echo "[".$types[$v['type']]."]".addslashes($v['title']);?>',
	                    y: <?php echo $v['shares'];?>,
	                    sliced: true,
	                    selected: true
	                },
					<?php else: ?>
					['<?php echo "[".$types[$v['type']]."]".addslashes($v['title']);?>',<?php echo $v['shares'];?>],
					<?php endif;?>
				<?php endforeach;?>
				]
			}]
		});
		//昨日
		$('#yestoday_charts').highcharts({
			credits:{
            	enabled:false
            },
			chart: {
				plotBackgroundColor: null,
				plotBorderWidth: null,
				plotShadow: false
			},
			title: {
				text: '本月被分享次数最多的前十个文档'
			},
			tooltip: {
				pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
			},
			plotOptions: {
				pie: {
					allowPointSelect: true,
					cursor: 'pointer',
					dataLabels: {
						enabled: true,
						color: '#000000',
						connectorColor: '#000000',
						format: '<b>{point.name}</b>:{y}次'
					}
				}
			},
			series: [{
				type: 'pie',
				name: '次数',
				data: [
				<?php foreach($yestoday_list as $k=>$v): ?>
					<?php if($k==0): ?>
					{
	                    name: '<?php echo "[".$types[$v['type']]."]".addslashes($v['title']);?>',
	                    y: <?php echo $v['shares'];?>,
	                    sliced: true,
	                    selected: true
	                },
					<?php else: ?>
					['<?php echo "[".$types[$v['type']]."]".addslashes($v['title']);?>',<?php echo $v['shares'];?>],
					<?php endif;?>
				<?php endforeach;?>
				]
			}]
		});
		//月统计
		$('#month_charts').highcharts({
			credits:{
            	enabled:false
            },
			chart: {
				plotBackgroundColor: null,
				plotBorderWidth: null,
				plotShadow: false
			},
			title: {
				text: '本月被分享次数最多的前十个文档'
			},
			tooltip: {
				pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
			},
			plotOptions: {
				pie: {
					allowPointSelect: true,
					cursor: 'pointer',
					dataLabels: {
						enabled: true,
						color: '#000000',
						connectorColor: '#000000',
						format: '<b>{point.name}</b>:{y}次'
					}
				}
			},
			series: [{
				type: 'pie',
				name: '次数',
				data: [
				<?php foreach($month_list as $k=>$v): ?>
					<?php if($k==0): ?>
					{
	                    name: '<?php echo "[".$types[$v['type']]."]".addslashes($v['title']);?>',
	                    y: <?php echo $v['shares'];?>,
	                    sliced: true,
	                    selected: true
	                },
					<?php else: ?>
					['<?php echo "[".$types[$v['type']]."]".addslashes($v['title']);?>',<?php echo $v['shares'];?>],
					<?php endif;?>
				<?php endforeach;?>
				]
			}]
		});
	});
</script>
<include file="Public:footer"/>
